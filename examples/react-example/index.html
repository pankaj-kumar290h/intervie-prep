<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>React - Todo App (CRP Demo)</title>
  
  <!-- 
    Note: In a real React app, you'd have a build process
    This example uses CDN for demonstration purposes
    
    Production React apps should use:
    - Build tools (Vite, Create React App, Next.js)
    - Code splitting
    - Tree shaking
    - Minification
  -->
  
  <style>
    /* Minimal loading styles - React will handle the rest */
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    #root {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    /* Loading indicator shown until React mounts */
    .loading-container {
      background: white;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f0f0f0;
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      color: #666;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <!-- Empty root - React will populate this -->
  <div id="root">
    <!-- Loading state shown until React mounts -->
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading React...</div>
      <div class="loading-text" style="font-size: 12px; margin-top: 10px;">
        This demonstrates the CRP delay when using client-side React
      </div>
    </div>
  </div>
  
  <!-- React and ReactDOM from CDN -->
  <!-- In production, use a bundler and import from npm -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  
  <!-- Babel for JSX transformation (development only) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Our React application -->
  <script type="text/babel" src="app.jsx"></script>
  
  <!-- Performance monitoring -->
  <script>
    // Measure when React actually renders content
    const startTime = performance.now();
    
    // Observer to detect when React replaces the loading state
    const observer = new MutationObserver(() => {
      const loadingContainer = document.querySelector('.loading-container');
      if (!loadingContainer) {
        const reactRenderTime = performance.now() - startTime;
        console.log('â±ï¸ Time until React rendered:', Math.round(reactRenderTime), 'ms');
        observer.disconnect();
      }
    });
    
    observer.observe(document.getElementById('root'), {
      childList: true,
      subtree: true
    });
    
    // Log CRP metrics
    window.addEventListener('load', () => {
      const perfData = performance.getEntriesByType('navigation')[0];
      console.log('ðŸš€ React Performance Metrics:');
      console.log('-----------------------------------');
      console.log('DOM Content Loaded:', Math.round(perfData.domContentLoadedEventEnd), 'ms');
      console.log('Page Fully Loaded:', Math.round(perfData.loadEventEnd), 'ms');
      
      // Calculate React bundle size from network
      const resources = performance.getEntriesByType('resource');
      let totalReactSize = 0;
      resources.forEach(resource => {
        if (resource.name.includes('react') || resource.name.includes('babel')) {
          totalReactSize += resource.transferSize || 0;
        }
      });
      console.log('React Bundle Size:', Math.round(totalReactSize / 1024), 'KB');
    });
    
    // Measure First Contentful Paint
    const paintObserver = new PerformanceObserver((entryList) => {
      for (const entry of entryList.getEntries()) {
        if (entry.name === 'first-contentful-paint') {
          console.log('First Contentful Paint:', Math.round(entry.startTime), 'ms');
        }
      }
    });
    
    paintObserver.observe({ entryTypes: ['paint'] });
  </script>
</body>
</html>

